<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Ad Reward Feed</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      background: #000;
    }

    #feed {
      height: 100vh;
      overflow-y: scroll;
      scroll-snap-type: y mandatory;
      position: relative;
    }

    .ad-slide {
      height: 100vh;
      scroll-snap-align: start;
      display: flex;
      justify-content: center;
      align-items: center;
      background: #111;
      color: #fff;
      font-size: 2rem;
      position: relative;
    }

    iframe {
      width: 100vw;
      height: 100vh;
      border: none;
    }

    .overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      z-index: 2;
      background: rgba(0, 0, 0, 0.5);
    }
  </style>
</head>
<body>

<div id="feed"></div>

<script>
  // Provide your Adsterra In-Stream Video Ad links
  const videoAds = [
    "https://www.profitableratecpm.com/dpm1etfub?key=c17d741f83dfa305ef138e543d71ac07",
    "https://www.profitableratecpm.com/pwk5nxk3dw?key=94c18238bd565dc5cd83ce5639cfdb1d",
    "https://www.profitableratecpm.com/y62e8qmuip?key=245c2ca7361808966960862f591ce56e",
    "https://www.profitableratecpm.com/zimmt2y1?key=fc32af5a8e710aa46529742259967d49",
    "https://www.profitableratecpm.com/d1s47ajq0?key=8f506c046ca8617da4327a299c88be85"
  ];

  const feed = document.getElementById('feed');
  let currentSlide = 0;
  let rewarded = [];
  let timers = [];

  // Function to create an ad slide
  function createVideoAdSlide(index, url) {
    const slide = document.createElement('div');
    slide.className = 'ad-slide';
    slide.dataset.index = index;

    const iframe = document.createElement('iframe');
    iframe.src = url;
    iframe.allow = "fullscreen; autoplay";
    slide.appendChild(iframe);

    const overlay = document.createElement('div');
    overlay.className = 'overlay';
    slide.appendChild(overlay);

    return slide;
  }

  // Load the video ads
  function loadVideoAds() {
    videoAds.forEach((link, index) => {
      const slide = createVideoAdSlide(index, link);
      feed.appendChild(slide);
      rewarded[index] = false;
      timers[index] = null;
    });
  }

  // Function to load more ads dynamically when scrolled
  function loadMoreVideoAds() {
    if (feed.scrollTop + feed.clientHeight >= feed.scrollHeight - 200) {
      const nextAdIndex = videoAds.length;
      const newLink = videoAds[nextAdIndex % videoAds.length]; // Loop through the ads
      videoAds.push(newLink);  // Add the new ad link to the list
      const newSlide = createVideoAdSlide(nextAdIndex, newLink);
      feed.appendChild(newSlide); // Add the new slide to the feed
      rewarded[nextAdIndex] = false;
      timers[nextAdIndex] = null;
    }
  }

  // Timer for tracking the video ad view
  function startTimer(index) {
    if (rewarded[index]) return;
    timers[index] = setTimeout(() => {
      rewarded[index] = true;
      console.log(`✅ Video Ad ${index + 1} viewed for 15s — reward granted`);

      // Send the reward notification to the app or backend
      if (window.ReactNativeWebView) {
        window.ReactNativeWebView.postMessage("videoAdViewed");
      } else {
        // For backend or external integration
        // window.external.notify("videoAdViewed");
      }
    }, 15000); // Timer set to 15 seconds per ad view
  }

  function stopTimer(index) {
    if (timers[index]) {
      clearTimeout(timers[index]);
      timers[index] = null;
    }
  }

  function handleScroll() {
    const index = Math.round(feed.scrollTop / window.innerHeight);
    for (let i = 0; i < videoAds.length; i++) {
      if (i === index) {
        startTimer(i);
      } else {
        stopTimer(i);
      }
    }
    loadMoreVideoAds(); // Check if we need to load more video ads as user scrolls
  }

  feed.addEventListener('scroll', () => {
    window.requestAnimationFrame(handleScroll);
  });

  // Start loading the video ads
  loadVideoAds();
  startTimer(0); // Start the first slide's timer immediately

</script>

</body>
</html>

</html>




